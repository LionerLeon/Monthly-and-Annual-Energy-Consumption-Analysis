[
  {
    "objectID": "index.html",
    "href": "index.html",
    "title": "Monthly and Annual Energy Consumption Analysis",
    "section": "",
    "text": "1 Introduction\nThe history of energy production can be traced back for thousands of years, and it serves as an important mark for the advancement in human culture, technology, and civilizations. Energy is not only crucial for our daily lives, but also serving for the foundation In recent decades, various sources for energy production have received attentions from scientists worldwide for different purposes. For a long time, fossil fuels have been the primary sources for energy, and yet the public have criticized its consequences on environmental harm and climate changes. In addition, due to the limited storage of fossil fuels on this planet, sustainable alternatives for coals and petroleum have been pushed to the to-do list. To this end, renewable sources, like hydro and solar power, have joined the stage. Other scientists have looked into fuels with higher energy density and starts to look for sites for nuclear power plants. All of those changes and development contributed to other changes in social, economic, and geopolitical changes which shaped our community.\nIn this project, we aim to gain insights on the change in sources of energy consumption and production over the past several decades in United States. We are interested in understanding and visualizing trends, if any, in preferences for sources of energy generated or used, as well as any seasonal or periodic rise or fall in total production or consumption of energy. We expect, through such study, to learn more about the emphasis of various sources of energy and consumption have evolved over time and help us visualize the future.",
    "crumbs": [
      "<span class='chapter-number'>1</span>  <span class='chapter-title'>Introduction</span>"
    ]
  },
  {
    "objectID": "index.html#data-source",
    "href": "index.html#data-source",
    "title": "Monthly and Annual Energy Consumption Analysis",
    "section": "1.1 Data Source",
    "text": "1.1 Data Source\nThe source of data: https://catalog.data.gov/dataset/monthly-and-annual-energy-consumption-by-sector\nThe data contains monthly data since January 1973 and annual data since 1949 on U.S. primary and total energy consumption by end-use sector (residential, commercial, industrial, transportation) and electric power sector.\nEach month, U.S. Energy Information Administration (EIA) produces publication detailing monthly energy consumption. The publication includes total energy production, consumption, stocks, and trade; energy prices; overviews of petroleum, natural gas, coal, electricity, nuclear energy, renewable energy, and carbon dioxide emissions; and data unit conversions values.\nFor this project, we have the compiled data till July 2024. This data will be used to perform data analysis and visualization.\nMore granular data on each energy source can be found in the following link: https://www.eia.gov/totalenergy/data/browser/",
    "crumbs": [
      "<span class='chapter-number'>1</span>  <span class='chapter-title'>Introduction</span>"
    ]
  },
  {
    "objectID": "data.html",
    "href": "data.html",
    "title": "2  Data",
    "section": "",
    "text": "2.1 Technical Description\nDataset Name: Monthly and Annual Energy Consumption by Sector\nThis dataset includes monthly data for energy production and consumption by different sectors depending on the sources, the origins, and the usages since 1973, and annual data since 1949 for the United States.This dataset is collected and published by the US Energy Information Administration on a monthly basis, where the organization release preliminary data for the new month, often estimated, and revise previous numbers.\nFor this project, we will examine the monthly and annual table for the primary energy sources (like petroleum, coal, nuclear, renewable), both available at data.gov offered by the Department of Energy at https://catalog.data.gov/dataset/monthly-and-annual-energy-consumption-by-sector\nThe data is available both in csv files, xls files, and pdf ready to be processed. For this project, we have downloaded 19 excels files and did initial analysis on the missing data in each of this excel files. Then we have combined the data from all the excel files into a single excel file for easy processing and analysis of the data.",
    "crumbs": [
      "<span class='chapter-number'>2</span>  <span class='chapter-title'>Data</span>"
    ]
  },
  {
    "objectID": "data.html#import-libraries",
    "href": "data.html#import-libraries",
    "title": "2  Data",
    "section": "2.2 Import Libraries",
    "text": "2.2 Import Libraries\n\n\nCode\ninvisible(library(readxl))\ninvisible(library(naniar))\ninvisible(library(ggplot2))\ninvisible(library(dplyr))\n\n\n\nAttaching package: 'dplyr'\n\n\nThe following objects are masked from 'package:stats':\n\n    filter, lag\n\n\nThe following objects are masked from 'package:base':\n\n    intersect, setdiff, setequal, union\n\n\nCode\ninvisible(library(tidyr))\ninvisible(library(stringr))\ninvisible(library(writexl))",
    "crumbs": [
      "<span class='chapter-number'>2</span>  <span class='chapter-title'>Data</span>"
    ]
  },
  {
    "objectID": "data.html#missing-value-analysis",
    "href": "data.html#missing-value-analysis",
    "title": "2  Data",
    "section": "2.3 Missing value analysis",
    "text": "2.3 Missing value analysis\n\n2.3.1 Energy Overview Data\n\n\nCode\nenergy_df_monthly &lt;- read_xlsx(path = \"./data_source/data/energy_overview_data.xlsx\", sheet=1, skip=9)\nenergy_df_monthly &lt;- energy_df_monthly[-1, ]\nenergy_df_monthly[, -1] &lt;- lapply(energy_df_monthly[, -1], as.numeric)\nenergy_df_monthly[[1]] &lt;- as.Date(energy_df_monthly[[1]])\nenergy_df_monthly\n\n\n\n  \n\n\n\nCode\nenergy_df_annual &lt;- read_xlsx(path='./data_source/data/energy_overview_data.xlsx', sheet=2, skip=9)\nenergy_df_annual &lt;- energy_df_annual[-1, ]\nenergy_df_annual[, -1] &lt;- lapply(energy_df_annual[, -1], as.numeric)\ncolnames(energy_df_annual)[1] &lt;- \"Year\"\nenergy_df_annual\n\n\n\n  \n\n\n\nThe original excel dataset contained metadata information like source, titles, etc. The top 9 rows of the excel contains metadata information which distorts the structure of the data. Therefore these metadata information is filtered out while importing the data into the R environment for easy data analysis.\nThe datatype of columns from column 2 to end is changed to numeric datatype. The datatype of column 1 is date.\nEach columns starting from Total Fossil Fuels Production shows energy production in Quadrillion Btu. 1 quad (short for quadrillion Btu) is 10^15 Btu, which is about 1 exajoule (1.055×10^18 J). Quads are used in the United States for representing the annual energy consumption of large economies: for example, the U.S. economy used 99.75 quads in 2005. One quad/year is about 33.43 gigawatts. (Source:British thermal unit)\n\n\nCode\nmissing_data_summary &lt;- data.frame(\n  Missing_Count = colSums(is.na(energy_df_monthly))\n)\n\nmissing_data_summary\n\n\n\n  \n\n\n\nCode\nmissing_data_summary &lt;- data.frame(\n  Missing_Count = colSums(is.na(energy_df_annual))\n)\n\nmissing_data_summary\n\n\n\n  \n\n\n\nThe dataset is summarized to get the amount of missing values in each column. As per the above table, there is no Null values in any of the columns of the dataset.\n\n\nCode\nvis_miss(energy_df_monthly) +\n  theme(\n    axis.text.x = element_text(angle = 270, hjust = 1),\n    axis.title = element_text(size = 10),\n    plot.title = element_text(hjust = 0.5, face = 'bold', color = 'darkblue'),\n    plot.subtitle = element_text(hjust = 0.5, color = 'darkblue')\n  ) + \n  labs(\n    title = \"Percentage of datapoints missing in each column\",\n    subtitle = \"Table: Evergy Overview Data (Monthly)\",\n    x = \"Column Variables\",\n    y = \"Number of Observations\"\n  )\n\n\n\n\n\n\n\n\n\nCode\nvis_miss(energy_df_annual) + \n  theme(\n    axis.text.x = element_text(angle=270, hjust=1),\n    axis.title = element_text(size=10),\n    plot.title = element_text(hjust=0.5, face='bold', color='darkblue'),\n    plot.subtitle = element_text(hjust = 0.5, color = 'darkblue')\n  ) +\n  labs(\n    title = \"Percentage of datapoints missing in each column\",\n    subtitle = \"Table: Evergy Overview Data (Annually)\",\n    x = \"Column Variables\",\n    y = \"Number of Observations\"\n  )\n\n\n\n\n\n\n\n\n\nThe above visualization shows each column variable has 0% missing data. There is no null or missing value in any of the columns of the dataset.\n\n\nCode\ngg_miss_var(energy_df_monthly) +\n  theme(\n    plot.title = element_text(hjust = 0.5, color = \"darkblue\", face = 'bold'),\n    plot.subtitle = element_text(hjust = 0.5, color = 'darkblue')\n  ) +\n  labs(\n    title = \"Missing Values by Column Variables\",\n    subtitle = \"Table: Evergy Overview Data (Monthly)\",\n    x = \"Column Variables\",\n    y = \"Number of Missing Values\"\n  )\n\n\n\n\n\n\n\n\n\nCode\ngg_miss_var(energy_df_annual) +\n  theme(\n    plot.title = element_text(face='bold', color='darkblue'),\n    plot.subtitle = element_text(hjust = 0.5, color = 'darkblue')\n  ) +\n  labs(\n    title = \"Missing Values by Column Variables (Annual Energy Data)\",\n    subtitle = \"Table: Evergy Overview Data (Annually)\",\n    x = \"Column Variables\",\n    y = \"Number of Missing Values\"\n  )\n\n\n\n\n\n\n\n\n\nThe above visualization is a another representation of data missingness. The above datapoints are all present at 0 mark. It shows none of the columns in the dataset has missing value.\n\n\n2.3.2 Primary Energy Production By Source Data\n\n\nCode\nenergy_df_monthly_pe_source &lt;- read_xlsx(path = \"./data_source/data/Table_1.2_Primary_Energy_Production_by_Source.xlsx\", sheet=1, skip=9)\nenergy_df_monthly_pe_source &lt;- energy_df_monthly_pe_source[-1, ]\nenergy_df_monthly_pe_source[, -1] &lt;- lapply(energy_df_monthly_pe_source[, -1], as.numeric)\nenergy_df_monthly_pe_source[[1]] &lt;- as.Date(energy_df_monthly_pe_source[[1]])\nenergy_df_monthly_pe_source\n\n\n\n  \n\n\n\nCode\nenergy_df_annual_pe_source &lt;- read_xlsx(path = \"./data_source/data/Table_1.2_Primary_Energy_Production_by_Source.xlsx\", sheet=2, skip=9)\nenergy_df_annual_pe_source &lt;- energy_df_annual_pe_source[-1, ]\nenergy_df_annual_pe_source[, -1] &lt;- lapply(energy_df_annual_pe_source[, -1], as.numeric)\nenergy_df_annual_pe_source[[1]] &lt;- as.Date(energy_df_annual_pe_source[[1]])\nenergy_df_annual_pe_source\n\n\n\n  \n\n\n\n\n\nCode\nvis_miss(energy_df_monthly_pe_source) + \n  theme(\n    axis.text.x = element_text(angle=270, hjust=1),\n    axis.title = element_text(size=10),\n    plot.title = element_text(hjust=0.5, face='bold', color='darkblue'),\n    plot.subtitle = element_text(hjust=0.5, color='darkblue')\n  ) +\n  labs(\n    title = \"Percentage of datapoints missing in each column\",\n    subtitle = \"Table: Primary Energy Production By Source (Monthly Data)\",\n    x = \"Column Variables\",\n    y = \"% of Observations\"\n  )\n\n\n\n\n\n\n\n\n\nCode\nvis_miss(energy_df_annual_pe_source) + \n  theme(\n    axis.text.x = element_text(angle=270, hjust=1),\n    axis.title = element_text(size=10),\n    plot.title = element_text(hjust=0.5, face='bold', color='darkblue'),\n    plot.subtitle = element_text(hjust=0.5, color='darkblue')\n  ) +\n  labs(\n    title = \"Percentage of datapoints missing in each column\",\n    subtitle = \"Table: Primary Energy Production By Source (Annual Data)\",\n    x = \"Column Variables\",\n    y = \"Number of Observations\"\n  )\n\n\n\n\n\n\n\n\n\nMonthly Data :\n\n“Solar Energy Production” has 21% of its data missing.\n“Wind Energy Production” has 19% of its data missing.\nOverall, 2.9% of the total data is missing, while 97.1% is present.\n\nAnnual Data :\n\nMost columns have no missing data (0% missing), including “Annual Total,” “Coal Production,” “Natural Gas (Dry) Production,” “Crude Oil Production,” and others.\n“Geothermal Energy Production” has 15% of its data missing. - “Solar Energy Production” has the highest percentage of missing data at 47%.\n“Wind Energy Production” also has a significant amount of missing data at 45%.\nOverall, 7.6% of the total data is missing, while 92.4% is present.\n\n\n\n2.3.3 Primary Energy Consumption By Source Data\n\n\nCode\nenergy_df_monthly_pe_consumption_source &lt;- read_xlsx(path = \"./data_source/data/Table_1.3_Primary_Energy_Consumption_by_Source.xlsx\", sheet=1, skip=9)\nenergy_df_monthly_pe_consumption_source &lt;- energy_df_monthly_pe_consumption_source[-1, ]\nenergy_df_monthly_pe_consumption_source[, -1] &lt;- lapply(energy_df_monthly_pe_consumption_source[, -1], as.numeric)\nenergy_df_monthly_pe_consumption_source[[1]] &lt;- as.Date(energy_df_monthly_pe_consumption_source[[1]])\nenergy_df_monthly_pe_consumption_source\n\n\n\n  \n\n\n\nCode\nenergy_df_annual_pe_consumption_source &lt;- read_xlsx(path = \"./data_source/data/Table_1.3_Primary_Energy_Consumption_by_Source.xlsx\", sheet=2, skip=9)\nenergy_df_annual_pe_consumption_source &lt;- energy_df_annual_pe_consumption_source[-1, ]\nenergy_df_annual_pe_consumption_source[, -1] &lt;- lapply(energy_df_annual_pe_consumption_source[, -1], as.numeric)\nenergy_df_annual_pe_consumption_source[[1]] &lt;- as.Date(energy_df_annual_pe_consumption_source[[1]])\nenergy_df_annual_pe_consumption_source\n\n\n\n  \n\n\n\n\n\nCode\nvis_miss(energy_df_monthly_pe_consumption_source) + \n  theme(\n    axis.text.x = element_text(angle=270, hjust=1),\n    axis.title = element_text(size=10),\n    plot.title = element_text(hjust=0.5, face='bold', color='darkblue'),\n    plot.subtitle = element_text(hjust=0.5, color='darkblue')\n  ) +\n  labs(\n    title = \"Percentage of datapoints missing in each column\",\n    subtitle = \"Table: Primary Energy Consumption By Source (Monthly Data)\",\n    x = \"Column Variables\",\n    y = \"Number of Observations\"\n  )\n\n\n\n\n\n\n\n\n\nCode\nvis_miss(energy_df_annual_pe_consumption_source) + \n  theme(\n    axis.text.x = element_text(angle=270, hjust=1),\n    axis.title = element_text(size=10),\n    plot.title = element_text(hjust=0.5, face='bold', color='darkblue'),\n    plot.subtitle = element_text(hjust=0.5, color='darkblue')\n  ) +\n  labs(\n    title = \"Percentage of datapoints missing in each column\",\n    subtitle = \"Table: Primary Energy Consumption By Source (Annual Data)\",\n    x = \"Column Variables\",\n    y = \"Number of Observations\"\n  )\n\n\n\n\n\n\n\n\n\nMonthly Data :\n\nWind Energy Consumption has the highest percentage of missing data points at 19%. This suggests that wind energy consumption data may be less reliable or less frequently collected compared to other energy sources.\nSolar Energy Consumption also has a high percentage of missing data points at 21%. This could be due to similar reasons as wind energy, or potentially due to the more recent and rapid growth of solar energy compared to other sources.\n\nAnnual Data :\n\nThe column with the highest percentage of missing data points is “Wind Energy Consumption,” with 45% of its data missing. This is followed by “Solar Energy Consumption” with 47% missing data.\nMost columns have no missing data points. These include columns like “Consumption,” “Total Renewable Energy Consumption,” and “Total Fossil Fuels Consumption.”\nThe dataset has a total of 100 observations.\n\n\n\n2.3.4 Primary Energy Imports Data\n\n\nCode\nenergy_df_monthly_pe_imports_source &lt;- read_xlsx(path = \"./data_source/data/Table_1.4a_Primary_Energy_Imports_by_Source.xlsx\", sheet=1, skip=9)\nenergy_df_monthly_pe_imports_source &lt;- energy_df_monthly_pe_imports_source[-1, ]\nenergy_df_monthly_pe_imports_source[, -1] &lt;- lapply(energy_df_monthly_pe_imports_source[, -1], as.numeric)\nenergy_df_monthly_pe_imports_source[[1]] &lt;- as.Date(energy_df_monthly_pe_imports_source[[1]])\nenergy_df_monthly_pe_imports_source\n\n\n\n  \n\n\n\nCode\nenergy_df_annual_pe_imports_source &lt;- read_xlsx(path = \"./data_source/data/Table_1.4a_Primary_Energy_Imports_by_Source.xlsx\", sheet=2, skip=9)\nenergy_df_annual_pe_imports_source &lt;- energy_df_annual_pe_imports_source[-1, ]\nenergy_df_annual_pe_imports_source[, -1] &lt;- lapply(energy_df_annual_pe_imports_source[, -1], as.numeric)\nenergy_df_annual_pe_imports_source[[1]] &lt;- as.Date(energy_df_annual_pe_imports_source[[1]])\nenergy_df_annual_pe_imports_source\n\n\n\n  \n\n\n\n\n\nCode\nvis_miss(energy_df_monthly_pe_imports_source) + \n  theme(\n    axis.text.x = element_text(angle=270, hjust=1),\n    axis.title = element_text(size=10),\n    plot.title = element_text(hjust=0.5, face='bold', color='darkblue'),\n    plot.subtitle = element_text(hjust=0.5, color='darkblue')\n  ) +\n  labs(\n    title = \"Percentage of datapoints missing in each column\",\n    subtitle = \"Table: Primary Energy Imports By Source (Monthly Data)\",\n    x = \"Column Variables\",\n    y = \"Number of Observations\"\n  )\n\n\n\n\n\n\n\n\n\nCode\nvis_miss(energy_df_annual_pe_imports_source) + \n  theme(\n    axis.text.x = element_text(angle=270, hjust=1),\n    axis.title = element_text(size=10),\n    plot.title = element_text(hjust=0.5, face='bold', color='darkblue'),\n    plot.subtitle = element_text(hjust=0.5, color='darkblue')\n  ) +\n  labs(\n    title = \"Percentage of datapoints missing in each column\",\n    subtitle = \"Table: Primary Energy Imports By Source (Annual Data)\",\n    x = \"Column Variables\",\n    y = \"Number of Observations\"\n  )\n\n\n\n\n\n\n\n\n\nMonthly Data:\n\nThe “Biomass Imports” columns stand out with around 30% missing data.\n\nAnnual Data:\n\nThe column with the highest percentage of missing data is “Biomass Imports” with 50% of its data points missing.\n\n\n\n2.3.5 Primary Energy Export Data\n\n\nCode\nenergy_df_monthly_pe_exports_source &lt;- read_xlsx(path = \"./data_source/data/Table_1.4b_Primary_Energy_Exports_by_Source.xlsx\", sheet=1, skip=9)\nenergy_df_monthly_pe_exports_source &lt;- energy_df_monthly_pe_exports_source[-1, ]\nenergy_df_monthly_pe_exports_source[, -1] &lt;- lapply(energy_df_monthly_pe_exports_source[, -1], as.numeric)\nenergy_df_monthly_pe_exports_source[[1]] &lt;- as.Date(energy_df_monthly_pe_exports_source[[1]])\nenergy_df_monthly_pe_exports_source\n\n\n\n  \n\n\n\nCode\nenergy_df_annual_pe_exports_source &lt;- read_xlsx(path = \"./data_source/data/Table_1.4b_Primary_Energy_Exports_by_Source.xlsx\", sheet=2, skip=9)\nenergy_df_annual_pe_exports_source &lt;- energy_df_annual_pe_exports_source[-1, ]\nenergy_df_annual_pe_exports_source[, -1] &lt;- lapply(energy_df_annual_pe_exports_source[, -1], as.numeric)\nenergy_df_annual_pe_exports_source[[1]] &lt;- as.Date(energy_df_annual_pe_exports_source[[1]])\nenergy_df_annual_pe_exports_source\n\n\n\n  \n\n\n\n\n\nCode\nvis_miss(energy_df_monthly_pe_exports_source) + \n  theme(\n    axis.text.x = element_text(angle=270, hjust=1),\n    axis.title = element_text(size=10),\n    plot.title = element_text(hjust=0.5, face='bold', color='darkblue'),\n    plot.subtitle = element_text(hjust=0.5, color='darkblue')\n  ) +\n  labs(\n    title = \"Percentage of datapoints missing in each column\",\n    subtitle = \"Table: Primary Energy Exports By Source (Monthly Data)\",\n    x = \"Column Variables\",\n    y = \"Number of Observations\"\n  )\n\n\n\n\n\n\n\n\n\nCode\nvis_miss(energy_df_annual_pe_exports_source) + \n  theme(\n    axis.text.x = element_text(angle=270, hjust=1),\n    axis.title = element_text(size=10),\n    plot.title = element_text(hjust=0.5, face='bold', color='darkblue'),\n    plot.subtitle = element_text(hjust=0.5, color='darkblue')\n  ) +\n  labs(\n    title = \"Percentage of datapoints missing in each column\",\n    subtitle = \"Table: Primary Energy Exports By Source (Annual Data)\",\n    x = \"Column Variables\",\n    y = \"Number of Observations\"\n  )\n\n\n\n\n\n\n\n\n\nMonthly Data:\n\nApproximately 5.4% of data points are missing across all columns. This means that out of all the data points in the dataset, 5.4% are not available.\nThe majority of columns have zero levels of missing data (0%). This indicates that for most variables, the data is mostly complete. There is one column, “Biomass Exports,” with a significantly higher proportion of missing data (54%). This suggests that this particular variable has the most incomplete data within the dataset.\n\nAnnual Data:\n\nApproximately 8.9% of data points are missing across all columns. This means that out of all the data points in the dataset, 8.9% are not available.\nThe majority of columns have zero levels of missing data (0%). This indicates that for most variables, the data is mostly complete. There is one column, “Electricity Exports,” with a significantly higher proportion of missing data (69%). This suggests that this particular variable has the most incomplete data within the dataset.\n\n\n\n2.3.6 Energy Consumption by Residentaial, Commercial and Industrial Sectors Data\n\n\nCode\nenergy_df_monthly_consumption_sector_1 &lt;- read_xlsx(path = \"./data_source/data/Table_2.1a_Energy_Consumption_Residential_Commercial_Industrial_Sectors.xlsx\", sheet=1, skip=9)\nenergy_df_monthly_consumption_sector_1 &lt;- energy_df_monthly_consumption_sector_1[-1, ]\nenergy_df_monthly_consumption_sector_1[, -1] &lt;- lapply(energy_df_monthly_consumption_sector_1[, -1], as.numeric)\nenergy_df_monthly_consumption_sector_1[[1]] &lt;- as.Date(energy_df_monthly_consumption_sector_1[[1]])\nenergy_df_monthly_consumption_sector_1\n\n\n\n  \n\n\n\nCode\nenergy_df_annual_consumption_sector_1 &lt;- read_xlsx(path = \"./data_source/data/Table_2.1a_Energy_Consumption_Residential_Commercial_Industrial_Sectors.xlsx\", sheet=2, skip=9)\nenergy_df_annual_consumption_sector_1 &lt;- energy_df_annual_consumption_sector_1[-1, ]\nenergy_df_annual_consumption_sector_1[, -1] &lt;- lapply(energy_df_annual_consumption_sector_1[, -1], as.numeric)\nenergy_df_annual_consumption_sector_1[[1]] &lt;- as.Date(energy_df_annual_consumption_sector_1[[1]])\nenergy_df_annual_consumption_sector_1\n\n\n\n  \n\n\n\n\n\nCode\nvis_miss(energy_df_monthly_consumption_sector_1) + \n  theme(\n    axis.text.x = element_text(angle=270, hjust=1),\n    axis.title = element_text(size=10),\n    plot.title = element_text(hjust=0.5, face='bold', color='darkblue'),\n    plot.subtitle = element_text(hjust=0.5, color='darkblue')\n  ) +\n  labs(\n    title = \"Percentage of datapoints missing in each column\",\n    subtitle = \"Table: Energy Consumption By Residential,Commercial and Industrial Sectors (Monthly Data)\",\n    x = \"Column Variables\",\n    y = \"Number of Observations\"\n  )\n\n\n\n\n\n\n\n\n\nCode\nvis_miss(energy_df_annual_consumption_sector_1) + \n  theme(\n    axis.text.x = element_text(angle=270, hjust=1),\n    axis.title = element_text(size=10),\n    plot.title = element_text(hjust=0.5, face='bold', color='darkblue'),\n    plot.subtitle = element_text(hjust=0.5, color='darkblue')\n  ) +\n  labs(\n    title = \"Percentage of datapoints missing in each column\",\n    subtitle = \"Table: Energy Consumption By Residential,Commercial and Industrial Sectors (Annual Data)\",\n    x = \"Column Variables\",\n    y = \"Number of Observations\"\n  )\n\n\n\n\n\n\n\n\n\nBoth of the charts show that all columns in the table have 0% missing datapoints. This means that there are no missing values in any of the columns. Having no missing data is generally good because it allows for more accurate and reliable analysis. It means that all the data points are present and can be used for calculations and modeling without any gaps.\n\n\n2.3.7 Energy Consumption By Transportaion, End and Electric Power Sectors Data\n\n\nCode\nenergy_df_monthly_consumption_sector_2 &lt;- read_xlsx(path = \"./data_source/data/Table_2.1b_Energy_Consumption_Transportation_Sector_Total_End-Use_Sectors_Electric_Power_Sector.xlsx\", sheet=1, skip=9)\nenergy_df_monthly_consumption_sector_2 &lt;- energy_df_monthly_consumption_sector_2[-1, ]\nenergy_df_monthly_consumption_sector_2[, -1] &lt;- lapply(energy_df_monthly_consumption_sector_2[, -1], as.numeric)\nenergy_df_monthly_consumption_sector_2[[1]] &lt;- as.Date(energy_df_monthly_consumption_sector_2[[1]])\nenergy_df_monthly_consumption_sector_2\n\n\n\n  \n\n\n\nCode\nenergy_df_annual_consumption_sector_2 &lt;- read_xlsx(path = \"./data_source/data/Table_2.1b_Energy_Consumption_Transportation_Sector_Total_End-Use_Sectors_Electric_Power_Sector.xlsx\", sheet=2, skip=9)\nenergy_df_annual_consumption_sector_2 &lt;- energy_df_annual_consumption_sector_2[-1, ]\nenergy_df_annual_consumption_sector_2[, -1] &lt;- lapply(energy_df_annual_consumption_sector_2[, -1], as.numeric)\nenergy_df_annual_consumption_sector_2[[1]] &lt;- as.Date(energy_df_annual_consumption_sector_2[[1]])\nenergy_df_annual_consumption_sector_2\n\n\n\n  \n\n\n\n\n\nCode\nvis_miss(energy_df_monthly_consumption_sector_1) + \n  theme(\n    axis.text.x = element_text(angle=270, hjust=1),\n    axis.title = element_text(size=10),\n    plot.title = element_text(hjust=0.5, face='bold', color='darkblue'),\n    plot.subtitle = element_text(hjust=0.5, color='darkblue')\n  ) +\n  labs(\n    title = \"Percentage of datapoints missing in each column\",\n    subtitle = \"Table: Energy Consumption By Transportation, Total End Use and Electric Power Sector (Monthly Data)\",\n    x = \"Column Variables\",\n    y = \"Number of Observations\"\n  )\n\n\n\n\n\n\n\n\n\nCode\nvis_miss(energy_df_annual_consumption_sector_1) + \n  theme(\n    axis.text.x = element_text(angle=270, hjust=1),\n    axis.title = element_text(size=10),\n    plot.title = element_text(hjust=0.5, face='bold', color='darkblue'),\n    plot.subtitle = element_text(hjust=0.5, color='darkblue')\n  ) +\n  labs(\n    title = \"Percentage of datapoints missing in each column\",\n    subtitle = \"Table: Energy Consumption By Transportation, Total End Use and Electric Power Sector (Annual Data)\",\n    x = \"Column Variables\",\n    y = \"Number of Observations\"\n  )\n\n\n\n\n\n\n\n\n\nBoth of the charts show that all columns in the table have 0% missing datapoints. This means that there are no missing values in any of the columns. Having no missing data is generally good because it allows for more accurate and reliable analysis. It means that all the data points are present and can be used for calculations and modeling without any gaps.\n\n\n2.3.8 Petroleum Data Overview\n\n\nCode\nenergy_df_monthly_petroleum &lt;- read_xlsx(path = \"./data_source/data/Table_3.1_Petroleum_Overview.xlsx\", sheet=1, skip=9)\nenergy_df_monthly_petroleum &lt;- energy_df_monthly_petroleum[-1, ]\nenergy_df_monthly_petroleum[, -1] &lt;- lapply(energy_df_monthly_petroleum[, -1], as.numeric)\nenergy_df_monthly_petroleum[[1]] &lt;- as.Date(energy_df_monthly_petroleum[[1]])\nenergy_df_monthly_petroleum\n\n\n\n  \n\n\n\nCode\nenergy_df_annual_petroleum &lt;- read_xlsx(path = \"./data_source/data/Table_3.1_Petroleum_Overview.xlsx\", sheet=2, skip=9)\nenergy_df_annual_petroleum &lt;- energy_df_annual_petroleum[-1, ]\nenergy_df_annual_petroleum[, -1] &lt;- lapply(energy_df_annual_petroleum[, -1], as.numeric)\nenergy_df_annual_petroleum[[1]] &lt;- as.Date(energy_df_annual_petroleum[[1]])\nenergy_df_annual_petroleum\n\n\n\n  \n\n\n\n\n\nCode\nvis_miss(energy_df_monthly_petroleum) + \n  theme(\n    axis.text.x = element_text(angle=270, hjust=1),\n    axis.title = element_text(size=10),\n    plot.title = element_text(hjust=0.5, face='bold', color='darkblue'),\n    plot.subtitle = element_text(hjust=0.5, color='darkblue')\n  ) +\n  labs(\n    title = \"Percentage of datapoints missing in each column\",\n    subtitle = \"Table: Petroleum Overview Data (Monthly Data)\",\n    x = \"Column Variables\",\n    y = \"Number of Observations\"\n  )\n\n\n\n\n\n\n\n\n\nCode\nvis_miss(energy_df_annual_petroleum) + \n  theme(\n    axis.text.x = element_text(angle=270, hjust=1),\n    axis.title = element_text(size=10),\n    plot.title = element_text(hjust=0.5, face='bold', color='darkblue'),\n    plot.subtitle = element_text(hjust=0.5, color='darkblue')\n  ) +\n  labs(\n    title = \"Percentage of datapoints missing in each column\",\n    subtitle = \"Table: Petroleum OVerview Data (Annual Data)\",\n    x = \"Column Variables\",\n    y = \"Number of Observations\"\n  )\n\n\n\n\n\n\n\n\n\n“Biofuels Plant Net Production” has the highest percentage of missing data points. There are 69% and 80% of data missing in each of the monthly and annual dataset.\n\n\n2.3.9 Petroleum Consumption By Residentail and Commercial Sectors Data\n\n\nCode\nenergy_df_monthly_petroleum_consumption_res_comm &lt;- read_xlsx(path = \"./data_source/data/Table_3.7a_Petroleum_Consumption_Residential_and_Commercial_Sectors.xlsx\", sheet=1, skip=9)\nenergy_df_monthly_petroleum_consumption_res_comm &lt;- energy_df_monthly_petroleum_consumption_res_comm[-1, ]\nenergy_df_monthly_petroleum_consumption_res_comm[, -1] &lt;- lapply(energy_df_monthly_petroleum_consumption_res_comm[, -1], as.numeric)\nenergy_df_monthly_petroleum_consumption_res_comm[[1]] &lt;- as.Date(energy_df_monthly_petroleum_consumption_res_comm[[1]])\nenergy_df_monthly_petroleum_consumption_res_comm\n\n\n\n  \n\n\n\nCode\nenergy_df_annual_petroleum_consumption_res_comm &lt;- read_xlsx(path = \"./data_source/data/Table_3.7a_Petroleum_Consumption_Residential_and_Commercial_Sectors.xlsx\", sheet=2, skip=9)\nenergy_df_annual_petroleum_consumption_res_comm &lt;- energy_df_annual_petroleum_consumption_res_comm[-1, ]\nenergy_df_annual_petroleum_consumption_res_comm[, -1] &lt;- lapply(energy_df_annual_petroleum_consumption_res_comm[, -1], as.numeric)\nenergy_df_annual_petroleum_consumption_res_comm[[1]] &lt;- as.Date(energy_df_annual_petroleum_consumption_res_comm[[1]])\nenergy_df_annual_petroleum_consumption_res_comm\n\n\n\n  \n\n\n\n\n\nCode\nvis_miss(energy_df_monthly_petroleum_consumption_res_comm) + \n  theme(\n    axis.text.x = element_text(angle=270, hjust=1),\n    axis.title = element_text(size=10),\n    plot.title = element_text(hjust=0.5, face='bold', color='darkblue'),\n    plot.subtitle = element_text(hjust=0.5, color='darkblue')\n  ) +\n  labs(\n    title = \"Percentage of datapoints missing in each column\",\n    subtitle = \"Table: Petroleum Consumption By Residential and Commercial Data (Monthly Data)\",\n    x = \"Column Variables\",\n    y = \"Number of Observations\"\n  )\n\n\n\n\n\n\n\n\n\nCode\nvis_miss(energy_df_annual_petroleum_consumption_res_comm) + \n  theme(\n    axis.text.x = element_text(angle=270, hjust=1),\n    axis.title = element_text(size=10),\n    plot.title = element_text(hjust=0.5, face='bold', color='darkblue'),\n    plot.subtitle = element_text(hjust=0.5, color='darkblue')\n  ) +\n  labs(\n    title = \"Percentage of datapoints missing in each column\",\n    subtitle = \"Table: Petroleum Consumption By Residential and Commercial Data (Annual Data)\",\n    x = \"Column Variables\",\n    y = \"Number of Observations\"\n  )\n\n\n\n\n\n\n\n\n\nMonthly Data:\n\nThe chart highlights that the majority of the data points in the dataset are present, with only one column (“Petroleum Coke Consumed by the Commercial Sector”) having a significant amount of missing data (31%).\n\nAnnual Data:\n\nThe chart highlights that the majority of the data points in the dataset are present, with only one column (“Petroleum Coke Consumed by the Commercial Sector”) having a significant amount of missing data (53%).\n\n\n\n2.3.10 Petroleum Consumption by Industrial Sector Data\n\n\nCode\nenergy_df_monthly_petroleum_consumption_indus &lt;- read_xlsx(path = \"./data_source/data/Table_3.7b_Petroleum_Consumption_Industrial_Sector.xlsx\", sheet=1, skip=9)\nenergy_df_monthly_petroleum_consumption_indus &lt;- energy_df_monthly_petroleum_consumption_indus[-1, ]\nenergy_df_monthly_petroleum_consumption_indus[, -1] &lt;- lapply(energy_df_monthly_petroleum_consumption_indus[, -1], as.numeric)\nenergy_df_monthly_petroleum_consumption_indus[[1]] &lt;- as.Date(energy_df_monthly_petroleum_consumption_indus[[1]])\nenergy_df_monthly_petroleum_consumption_indus\n\n\n\n  \n\n\n\nCode\nenergy_df_annual_petroleum_consumption_indus &lt;- read_xlsx(path = \"./data_source/data/Table_3.7b_Petroleum_Consumption_Industrial_Sector.xlsx\", sheet=2, skip=9)\nenergy_df_annual_petroleum_consumption_indus &lt;- energy_df_annual_petroleum_consumption_indus[-1, ]\nenergy_df_annual_petroleum_consumption_indus[, -1] &lt;- lapply(energy_df_annual_petroleum_consumption_indus[, -1], as.numeric)\nenergy_df_annual_petroleum_consumption_indus[[1]] &lt;- as.Date(energy_df_annual_petroleum_consumption_indus[[1]])\nenergy_df_annual_petroleum_consumption_indus\n\n\n\n  \n\n\n\n\n\nCode\nvis_miss(energy_df_monthly_petroleum_consumption_indus) + \n  theme(\n    axis.text.x = element_text(angle=270, hjust=1),\n    axis.title = element_text(size=10),\n    plot.title = element_text(hjust=0.5, face='bold', color='darkblue'),\n    plot.subtitle = element_text(hjust=0.5, color='darkblue')\n  ) +\n  labs(\n    title = \"Percentage of datapoints missing in each column\",\n    subtitle = \"Table: Petroleum Consumption By Industrial Data (Monthly Data)\",\n    x = \"Column Variables\",\n    y = \"Number of Observations\"\n  )\n\n\n\n\n\n\n\n\n\nCode\nvis_miss(energy_df_annual_petroleum_consumption_indus) + \n  theme(\n    axis.text.x = element_text(angle=270, hjust=1),\n    axis.title = element_text(size=10),\n    plot.title = element_text(hjust=0.5, face='bold', color='darkblue'),\n    plot.subtitle = element_text(hjust=0.5, color='darkblue')\n  ) +\n  labs(\n    title = \"Percentage of datapoints missing in each column\",\n    subtitle = \"Table: Petroleum Consumption By Industrial Sector Data (Annual Data)\",\n    x = \"Column Variables\",\n    y = \"Number of Observations\"\n  )\n\n\n\n\n\n\n\n\n\nThere is no missing data in any of the dataset as per these graphs. The dataset is complete.\n\n\n2.3.11 Petroleum Consumption By Transportation and Electric Power Sector Data\n\n\nCode\nenergy_df_monthly_petroleum_consumption_trans &lt;- read_xlsx(path = \"./data_source/data/Table_3.7c_Petroleum_Consumption_Transportation_and_Electric_Power_Sectors.xlsx\", sheet=1, skip=9)\nenergy_df_monthly_petroleum_consumption_trans &lt;- energy_df_monthly_petroleum_consumption_trans[-1, ]\nenergy_df_monthly_petroleum_consumption_trans[, -1] &lt;- lapply(energy_df_monthly_petroleum_consumption_trans[, -1], as.numeric)\nenergy_df_monthly_petroleum_consumption_trans[[1]] &lt;- as.Date(energy_df_monthly_petroleum_consumption_trans[[1]])\nenergy_df_monthly_petroleum_consumption_trans\n\n\n\n  \n\n\n\nCode\nenergy_df_annual_petroleum_consumption_trans &lt;- read_xlsx(path = \"./data_source/data/Table_3.7c_Petroleum_Consumption_Transportation_and_Electric_Power_Sectors.xlsx\", sheet=2, skip=9)\nenergy_df_annual_petroleum_consumption_trans &lt;- energy_df_annual_petroleum_consumption_trans[-1, ]\nenergy_df_annual_petroleum_consumption_trans[, -1] &lt;- lapply(energy_df_annual_petroleum_consumption_trans[, -1], as.numeric)\nenergy_df_annual_petroleum_consumption_trans[[1]] &lt;- as.Date(energy_df_annual_petroleum_consumption_trans[[1]])\nenergy_df_annual_petroleum_consumption_trans\n\n\n\n  \n\n\n\n\n\nCode\nvis_miss(energy_df_monthly_petroleum_consumption_trans) + \n  theme(\n    axis.text.x = element_text(angle=270, hjust=1),\n    axis.title = element_text(size=10),\n    plot.title = element_text(hjust=0.5, face='bold', color='darkblue'),\n    plot.subtitle = element_text(hjust=0.5, color='darkblue')\n  ) +\n  labs(\n    title = \"Percentage of datapoints missing in each column\",\n    subtitle = \"Table: Petroleum Consumption By Transportation and Electric Power Sector Data (Monthly Data)\",\n    x = \"Column Variables\",\n    y = \"Number of Observations\"\n  )\n\n\n\n\n\n\n\n\n\nCode\nvis_miss(energy_df_annual_petroleum_consumption_trans) + \n  theme(\n    axis.text.x = element_text(angle=270, hjust=1),\n    axis.title = element_text(size=10),\n    plot.title = element_text(hjust=0.5, face='bold', color='darkblue'),\n    plot.subtitle = element_text(hjust=0.5, color='darkblue')\n  ) +\n  labs(\n    title = \"Percentage of datapoints missing in each column\",\n    subtitle = \"Table: Petroleum Consumption By Transportation and Electric Power Sector Data (Annual Data)\",\n    x = \"Column Variables\",\n    y = \"Number of Observations\"\n  )\n\n\n\n\n\n\n\n\n\nMonthly Data:\n\nHigh Percentage of Missing Data in “Other Products Consumed by the Transportation Sector”. This column has the highest percentage of missing data points, with 93% of the data missing. This could be due to various reasons, such as data collection limitations or the nature of the data itself.\n\nAnnual Data:\nA few columns stand out with higher percentages of missing data. These include:\n\n“Petroleum Coke Consumed by the Electric Power Sector” (28% missing)\n“Other Products Consumed by the Transportation Sector” (96% missing)\n“Jet Fuel Consumed by the Transportation Sector” (4% missing)\n\n\n\n2.3.12 Natural Gas Data Overview\n\n\nCode\nenergy_df_monthly_natural_gas &lt;- read_xlsx(path = \"./data_source/data/Table_4.1_Natural_Gas_Overview.xlsx\", sheet=1, skip=9)\nenergy_df_monthly_natural_gas &lt;- energy_df_monthly_natural_gas[-1, ]\nenergy_df_monthly_natural_gas[, -1] &lt;- lapply(energy_df_monthly_natural_gas[, -1], as.numeric)\nenergy_df_monthly_natural_gas[[1]] &lt;- as.Date(energy_df_monthly_natural_gas[[1]])\nenergy_df_monthly_natural_gas\n\n\n\n  \n\n\n\nCode\nenergy_df_annual_natural_gas &lt;- read_xlsx(path = \"./data_source/data/Table_4.1_Natural_Gas_Overview.xlsx\", sheet=2, skip=9)\nenergy_df_annual_natural_gas &lt;- energy_df_annual_natural_gas[-1, ]\nenergy_df_annual_natural_gas[, -1] &lt;- lapply(energy_df_annual_natural_gas[, -1], as.numeric)\nenergy_df_annual_natural_gas[[1]] &lt;- as.Date(energy_df_annual_natural_gas[[1]])\nenergy_df_annual_natural_gas\n\n\n\n  \n\n\n\n\n\nCode\nvis_miss(energy_df_monthly_natural_gas) + \n  theme(\n    axis.text.x = element_text(angle=270, hjust=1),\n    axis.title = element_text(size=10),\n    plot.title = element_text(hjust=0.5, face='bold', color='darkblue'),\n    plot.subtitle = element_text(hjust=0.5, color='darkblue')\n  ) +\n  labs(\n    title = \"Percentage of datapoints missing in each column\",\n    subtitle = \"Table: Natural Gas Overview Data (Monthly Data)\",\n    x = \"Column Variables\",\n    y = \"Number of Observations\"\n  )\n\n\n\n\n\n\n\n\n\nCode\nvis_miss(energy_df_annual_natural_gas) + \n  theme(\n    axis.text.x = element_text(angle=270, hjust=1),\n    axis.title = element_text(size=10),\n    plot.title = element_text(hjust=0.5, face='bold', color='darkblue'),\n    plot.subtitle = element_text(hjust=0.5, color='darkblue')\n  ) +\n  labs(\n    title = \"Percentage of datapoints missing in each column\",\n    subtitle = \"Table: Natural Gas Data (Annual Data)\",\n    x = \"Column Variables\",\n    y = \"Number of Observations\"\n  )\n\n\n\n\n\n\n\n\n\nMonthly Data:\n\nIn the monthly data, there are 3 columns with missing data as per the graph. The missing percentage is 14%, 14% and 5% respectively.\n\nAnnual Data:\n\nMost columns have no missing data: The majority of the columns have 0% missing data, represented by the full gray bars. Supplemental Gaseous Fuels has the highest missing data has 41% missing data, represented by the tall black bar. All other columns have 0% missing data: The remaining columns have no missing data.\n\n\n\n2.3.13 Natural Gas Consumption By Sector Data\n\n\nCode\nenergy_df_monthly_natural_gas_consumption &lt;- read_xlsx(path = \"./data_source/data/Table_4.3_Natural_Gas_Consumption_by_Sector.xlsx\", sheet=1, skip=9)\nenergy_df_monthly_natural_gas_consumption &lt;- energy_df_monthly_natural_gas_consumption[-1, ]\nenergy_df_monthly_natural_gas_consumption[, -1] &lt;- lapply(energy_df_monthly_natural_gas_consumption[, -1], as.numeric)\nenergy_df_monthly_natural_gas_consumption[[1]] &lt;- as.Date(energy_df_monthly_natural_gas_consumption[[1]])\nenergy_df_monthly_natural_gas_consumption\n\n\n\n  \n\n\n\nCode\nenergy_df_annual_natural_gas_consumption &lt;- read_xlsx(path = \"./data_source/data/Table_4.3_Natural_Gas_Consumption_by_Sector.xlsx\", sheet=2, skip=9)\nenergy_df_annual_natural_gas_consumption &lt;- energy_df_annual_natural_gas_consumption[-1, ]\nenergy_df_annual_natural_gas_consumption[, -1] &lt;- lapply(energy_df_annual_natural_gas_consumption[, -1], as.numeric)\nenergy_df_annual_natural_gas_consumption[[1]] &lt;- as.Date(energy_df_annual_natural_gas_consumption[[1]])\nenergy_df_annual_natural_gas_consumption\n\n\n\n  \n\n\n\n\n\nCode\nvis_miss(energy_df_monthly_natural_gas_consumption) + \n  theme(\n    axis.text.x = element_text(angle=270, hjust=1),\n    axis.title = element_text(size=10),\n    plot.title = element_text(hjust=0.5, face='bold', color='darkblue'),\n    plot.subtitle = element_text(hjust=0.5, color='darkblue')\n  ) +\n  labs(\n    title = \"Percentage of datapoints missing in each column\",\n    subtitle = \"Table: Natural Gas Consumption By Sector Data (Monthly Data)\",\n    x = \"Column Variables\",\n    y = \"Number of Observations\"\n  )\n\n\n\n\n\n\n\n\n\nCode\nvis_miss(energy_df_annual_natural_gas_consumption) + \n  theme(\n    axis.text.x = element_text(angle=270, hjust=1),\n    axis.title = element_text(size=10),\n    plot.title = element_text(hjust=0.5, face='bold', color='darkblue'),\n    plot.subtitle = element_text(hjust=0.5, color='darkblue')\n  ) +\n  labs(\n    title = \"Percentage of datapoints missing in each column\",\n    subtitle = \"Table: Natural Gas Consumption By Sector Data (Annual Data)\",\n    x = \"Column Variables\",\n    y = \"Number of Observations\"\n  )\n\n\n\n\n\n\n\n\n\nMonthly Data:\n\nThe dataset has a total of 600 observations. There is a small percentage of missing data across the columns.\nThe dataset has a relatively high percentage of missing data in two specific columns: “Natural Gas Consumed by the Transportation Sector, Vehicle Fuel” and “Natural Gas Consumed by the Other Industrial Sector, CHP.”\n\nAnnual Data:\n\nThe dataset has a total of 15 columns. 8.5% of the data points across all columns are missing. 91.5% of the data points are present.\nMost columns have no missing data (0%). The column “Natural Gas Consumed by the Transportation Sector, Vehicle Fuel” has the highest percentage of missing data, with 55% of its values missing. The column “Natural Gas Consumed by the Other Industrial Sector, CHP” has 53% of its values missing.\n\n\n\n2.3.14 Coal Data Overview\n\n\nCode\nenergy_df_monthly_coal &lt;- read_xlsx(path = \"./data_source/data/Table_6.1_Coal_Overview.xlsx\", sheet=1, skip=9)\nenergy_df_monthly_coal &lt;- energy_df_monthly_coal[-1, ]\nenergy_df_monthly_coal[, -1] &lt;- lapply(energy_df_monthly_coal[, -1], as.numeric)\nenergy_df_monthly_coal[[1]] &lt;- as.Date(energy_df_monthly_coal[[1]])\nenergy_df_monthly_coal\n\n\n\n  \n\n\n\nCode\nenergy_df_annual_coal &lt;- read_xlsx(path = \"./data_source/data/Table_6.1_Coal_Overview.xlsx\", sheet=2, skip=9)\nenergy_df_annual_coal &lt;- energy_df_annual_coal[-1, ]\nenergy_df_annual_coal[, -1] &lt;- lapply(energy_df_annual_coal[, -1], as.numeric)\nenergy_df_annual_coal[[1]] &lt;- as.Date(energy_df_annual_coal[[1]])\nenergy_df_annual_coal\n\n\n\n  \n\n\n\n\n\nCode\nvis_miss(energy_df_monthly_coal) + \n  theme(\n    axis.text.x = element_text(angle=270, hjust=1),\n    axis.title = element_text(size=10),\n    plot.title = element_text(hjust=0.5, face='bold', color='darkblue'),\n    plot.subtitle = element_text(hjust=0.5, color='darkblue')\n  ) +\n  labs(\n    title = \"Percentage of datapoints missing in each column\",\n    subtitle = \"Table: Coal Overview Data (Monthly Data)\",\n    x = \"Column Variables\",\n    y = \"Number of Observations\"\n  )\n\n\n\n\n\n\n\n\n\nCode\nvis_miss(energy_df_annual_coal) + \n  theme(\n    axis.text.x = element_text(angle=270, hjust=1),\n    axis.title = element_text(size=10),\n    plot.title = element_text(hjust=0.5, face='bold', color='darkblue'),\n    plot.subtitle = element_text(hjust=0.5, color='darkblue')\n  ) +\n  labs(\n    title = \"Percentage of datapoints missing in each column\",\n    subtitle = \"Table: Coal Overview Data (Annual Data)\",\n    x = \"Column Variables\",\n    y = \"Number of Observations\"\n  )\n\n\n\n\n\n\n\n\n\nThe dataset has a relatively high percentage of missing data in one specific column: “Waste Coal Supplied” in both the charts.\n\n\n2.3.15 Coal Consumption By Sectors Data\n\n\nCode\nenergy_df_monthly_coal_cons &lt;- read_xlsx(path = \"./data_source/data/Table_6.2_Coal_Consumption_by_Sector.xlsx\", sheet=1, skip=9)\nenergy_df_monthly_coal_cons &lt;- energy_df_monthly_coal_cons[-1, ]\nenergy_df_monthly_coal_cons[, -1] &lt;- lapply(energy_df_monthly_coal_cons[, -1], as.numeric)\nenergy_df_monthly_coal_cons[[1]] &lt;- as.Date(energy_df_monthly_coal_cons[[1]])\nenergy_df_monthly_coal_cons\n\n\n\n  \n\n\n\nCode\nenergy_df_annual_coal_cons &lt;- read_xlsx(path = \"./data_source/data/Table_6.2_Coal_Consumption_by_Sector.xlsx\", sheet=2, skip=9)\nenergy_df_annual_coal_cons &lt;- energy_df_annual_coal_cons[-1, ]\nenergy_df_annual_coal_cons[, -1] &lt;- lapply(energy_df_annual_coal_cons[, -1], as.numeric)\nenergy_df_annual_coal_cons[[1]] &lt;- as.Date(energy_df_annual_coal_cons[[1]])\nenergy_df_annual_coal_cons\n\n\n\n  \n\n\n\n\n\nCode\nvis_miss(energy_df_monthly_coal_cons) + \n  theme(\n    axis.text.x = element_text(angle=270, hjust=1),\n    axis.title = element_text(size=10),\n    plot.title = element_text(hjust=0.5, face='bold', color='darkblue'),\n    plot.subtitle = element_text(hjust=0.5, color='darkblue')\n  ) +\n  labs(\n    title = \"Percentage of datapoints missing in each column\",\n    subtitle = \"Table: Coal Consumption By Sector Data (Monthly Data)\",\n    x = \"Column Variables\",\n    y = \"Number of Observations\"\n  )\n\n\n\n\n\n\n\n\n\nCode\nvis_miss(energy_df_annual_coal_cons) + \n  theme(\n    axis.text.x = element_text(angle=270, hjust=1),\n    axis.title = element_text(size=10),\n    plot.title = element_text(hjust=0.5, face='bold', color='darkblue'),\n    plot.subtitle = element_text(hjust=0.5, color='darkblue')\n  ) +\n  labs(\n    title = \"Percentage of datapoints missing in each column\",\n    subtitle = \"Table: Coal Consumption By Sector  Data (Annual Data)\",\n    x = \"Column Variables\",\n    y = \"Number of Observations\"\n  )\n\n\n\n\n\n\n\n\n\nMonthly Data:\n\nThe dataset has 7.2% of data points missing across all columns. The most missing data is in the “Coal Consumed by the Residential Sector” column (32%), followed by “Coal Consumed by the Commercial Sector, CHP” and “Coal Consumed by the Other Industrial Sector, CHP” (both at 31%).\n\nAnnual Data:\n\nThe dataset has 9.8% of data points missing across all columns. The most missing data is in the “Coal Consumed by the Residential Sector” column (21%), followed by “Coal Consumed by the Commercial Sector, CHP” and “Coal Consumed by the Other Industrial Sector, CHP” (both at 53%).\n\n\n\n2.3.16 Nuclear Energy Data Overview\n\n\nCode\nenergy_df_monthly_nuclear &lt;- read_xlsx(path = \"./data_source/data/Table_8.1_Nuclear_Energy_Overview.xlsx\", sheet=1, skip=9)\nenergy_df_monthly_nuclear &lt;- energy_df_monthly_nuclear[-1, ]\nenergy_df_monthly_nuclear[, -1] &lt;- lapply(energy_df_monthly_nuclear[, -1], as.numeric)\nenergy_df_monthly_nuclear[[1]] &lt;- as.Date(energy_df_monthly_nuclear[[1]])\nenergy_df_monthly_nuclear\n\n\n\n  \n\n\n\nCode\nenergy_df_annual_nuclear &lt;- read_xlsx(path = \"./data_source/data/Table_8.1_Nuclear_Energy_Overview.xlsx\", sheet=2, skip=9)\nenergy_df_annual_nuclear &lt;- energy_df_annual_nuclear[-1, ]\nenergy_df_annual_nuclear[, -1] &lt;- lapply(energy_df_annual_nuclear[, -1], as.numeric)\nenergy_df_annual_nuclear[[1]] &lt;- as.Date(energy_df_annual_nuclear[[1]])\nenergy_df_annual_nuclear\n\n\n\n  \n\n\n\n\n\nCode\nvis_miss(energy_df_monthly_nuclear) + \n  theme(\n    axis.text.x = element_text(angle=270, hjust=1),\n    axis.title = element_text(size=10),\n    plot.title = element_text(hjust=0.5, face='bold', color='darkblue'),\n    plot.subtitle = element_text(hjust=0.5, color='darkblue')\n  ) +\n  labs(\n    title = \"Percentage of datapoints missing in each column\",\n    subtitle = \"Table: Coal Consumption By Sector Data (Monthly Data)\",\n    x = \"Column Variables\",\n    y = \"Number of Observations\"\n  )\n\n\n\n\n\n\n\n\n\nCode\nvis_miss(energy_df_annual_nuclear) + \n  theme(\n    axis.text.x = element_text(angle=270, hjust=1),\n    axis.title = element_text(size=10),\n    plot.title = element_text(hjust=0.5, face='bold', color='darkblue'),\n    plot.subtitle = element_text(hjust=0.5, color='darkblue')\n  ) +\n  labs(\n    title = \"Percentage of datapoints missing in each column\",\n    subtitle = \"Table: Coal Consumption By Sector  Data (Annual Data)\",\n    x = \"Column Variables\",\n    y = \"Number of Observations\"\n  )\n\n\n\n\n\n\n\n\n\nMonthly Data:\n\nNuclear Generating Units, Total Operable Units: This column has the highest percentage of missing data points, with 39% of its values missing.\n\nAnnual Data:\n\nNuclear Generating Units, Capacity Factor (24%): This column has 24% of its data points missing.\n\n\n\n2.3.17 Average Electricity Price Data\n\n\nCode\nenergy_df_monthly_price &lt;- read_xlsx(path = \"./data_source/data/Table_9.8_Average_Prices_of_Electricity.xlsx\", sheet=1, skip=9)\nenergy_df_monthly_price &lt;- energy_df_monthly_price[-1, ]\nenergy_df_monthly_price[, -1] &lt;- lapply(energy_df_monthly_price[, -1], as.numeric)\nenergy_df_monthly_price[[1]] &lt;- as.Date(energy_df_monthly_price[[1]])\nenergy_df_monthly_price\n\n\n\n  \n\n\n\nCode\nenergy_df_annual_price &lt;- read_xlsx(path = \"./data_source/data/Table_9.8_Average_Prices_of_Electricity.xlsx\", sheet=2, skip=9)\nenergy_df_annual_price &lt;- energy_df_annual_price[-1, ]\nenergy_df_annual_price[, -1] &lt;- lapply(energy_df_annual_price[, -1], as.numeric)\nenergy_df_annual_price[[1]] &lt;- as.Date(energy_df_annual_price[[1]])\nenergy_df_annual_price\n\n\n\n  \n\n\n\n\n\nCode\nvis_miss(energy_df_monthly_price) + \n  theme(\n    axis.text.x = element_text(angle=270, hjust=1),\n    axis.title = element_text(size=10),\n    plot.title = element_text(hjust=0.5, face='bold', color='darkblue'),\n    plot.subtitle = element_text(hjust=0.5, color='darkblue')\n  ) +\n  labs(\n    title = \"Percentage of datapoints missing in each column\",\n    subtitle = \"Table: Avergar Electricity Price Data (Monthly Data)\",\n    x = \"Column Variables\",\n    y = \"Number of Observations\"\n  )\n\n\n\n\n\n\n\n\n\nCode\nvis_miss(energy_df_annual_price) + \n  theme(\n    axis.text.x = element_text(angle=270, hjust=1),\n    axis.title = element_text(size=10),\n    plot.title = element_text(hjust=0.5, face='bold', color='darkblue'),\n    plot.subtitle = element_text(hjust=0.5, color='darkblue')\n  ) +\n  labs(\n    title = \"Percentage of datapoints missing in each column\",\n    subtitle = \"Table: Average Electricity Price Data (Annual Data)\",\n    x = \"Column Variables\",\n    y = \"Number of Observations\"\n  )\n\n\n\n\n\n\n\n\n\nMonthly Data:\n\nThe majority of the columns have some missing data, with the exception of the “Month” column.\nThe column “Average Price of Electricity to Ultimate Customers, Other” has the highest percentage of missing data (73%).\nThe columns “Average Price of Electricity to Ultimate Customers, Transportation” and “Average Price of Electricity to Ultimate Customers, Residential,” “Average Price of Electricity to Ultimate Customers, Commercial,” and “Average Price of Electricity to Ultimate Customers, Industrial” have 50%, 13%, 13%, and 13% missing data, respectively.\n\nAnnual Data:\n\nThe column “Average Price of Electricity to Ultimate Customers, Transportation” has the highest percentage of missing data (67%).\nThe column “Average Price of Electricity to Ultimate Customers, Other” has 33% missing data.\n\n\n\n2.3.18 Renewable Energy Production and Consumption by Sectors Data\n\n\nCode\nenergy_df_monthly_renewable &lt;- read_xlsx(path = \"./data_source/data/Table_10.1_Renewable_Energy_Production_and_Consumption_by_Source.xlsx\", sheet=1, skip=9)\nenergy_df_monthly_renewable &lt;- energy_df_monthly_renewable[-1, ]\nenergy_df_monthly_renewable[, -1] &lt;- lapply(energy_df_monthly_renewable[, -1], as.numeric)\nenergy_df_monthly_renewable[[1]] &lt;- as.Date(energy_df_monthly_renewable[[1]])\nenergy_df_monthly_renewable\n\n\n\n  \n\n\n\nCode\nenergy_df_annual_renewable &lt;- read_xlsx(path = \"./data_source/data/Table_10.1_Renewable_Energy_Production_and_Consumption_by_Source.xlsx\", sheet=2, skip=9)\nenergy_df_annual_renewable &lt;- energy_df_annual_renewable[-1, ]\nenergy_df_annual_renewable[, -1] &lt;- lapply(energy_df_annual_renewable[, -1], as.numeric)\nenergy_df_annual_renewable[[1]] &lt;- as.Date(energy_df_annual_renewable[[1]])\nenergy_df_annual_renewable\n\n\n\n  \n\n\n\n\n\nCode\nvis_miss(energy_df_monthly_renewable) + \n  theme(\n    axis.text.x = element_text(angle=270, hjust=1),\n    axis.title = element_text(size=10),\n    plot.title = element_text(hjust=0.5, face='bold', color='darkblue'),\n    plot.subtitle = element_text(hjust=0.5, color='darkblue')\n  ) +\n  labs(\n    title = \"Percentage of datapoints missing in each column\",\n    subtitle = \"Table: Renewable Energy Data (Monthly Data)\",\n    x = \"Column Variables\",\n    y = \"Number of Observations\"\n  )\n\n\n\n\n\n\n\n\n\nCode\nvis_miss(energy_df_annual_renewable) + \n  theme(\n    axis.text.x = element_text(angle=270, hjust=1),\n    axis.title = element_text(size=10),\n    plot.title = element_text(hjust=0.5, face='bold', color='darkblue'),\n    plot.subtitle = element_text(hjust=0.5, color='darkblue')\n  ) +\n  labs(\n    title = \"Percentage of datapoints missing in each column\",\n    subtitle = \"Table: Renewable Data (Annual Data)\",\n    x = \"Column Variables\",\n    y = \"Number of Observations\"\n  )\n\n\n\n\n\n\n\n\n\nMonthly Data:\n\nThe majority of the columns have no missing data.\nThe column “Solar Energy Consumption” has the highest percentage of missing data (21%).\nThe column “Wind Energy Consumption” has 19% missing data.\nThe columns “Total Biofuels Consumption” and “Total Biofuels Production” have 15% missing data.\n\nAnnual Data:\n\nThe majority of the columns have no missing data.\nThe column “Solar Energy Consumption” has the highest percentage of missing data (47%).\nThe column “Wind Energy Consumption” has 45% missing data.\nThe column “Waste Energy Consumption” has 28% missing data.\nOther columns like “Biofuels Production”, “Biofuels Consumption” and “Geothermal Energy Consumption” has certain percentage of missing data.\n\n\n\n2.3.19 CO2 Emissions Data\n\n\nCode\nenergy_df_monthly_co2 &lt;- read_xlsx(path = \"./data_source/data/Table_11.1_Carbon_Dioxide_Emissions_From_Energy_Consumption_by_Source.xlsx\", sheet=1, skip=9)\nenergy_df_monthly_co2 &lt;- energy_df_monthly_co2[-1, ]\nenergy_df_monthly_co2[, -1] &lt;- lapply(energy_df_monthly_co2[, -1], as.numeric)\nenergy_df_monthly_co2[[1]] &lt;- as.Date(energy_df_monthly_co2[[1]])\nenergy_df_monthly_co2\n\n\n\n  \n\n\n\nCode\nenergy_df_annual_co2 &lt;- read_xlsx(path = \"./data_source/data/Table_11.1_Carbon_Dioxide_Emissions_From_Energy_Consumption_by_Source.xlsx\", sheet=2, skip=9)\nenergy_df_annual_co2 &lt;- energy_df_annual_co2[-1, ]\nenergy_df_annual_co2[, -1] &lt;- lapply(energy_df_annual_co2[, -1], as.numeric)\nenergy_df_annual_co2[[1]] &lt;- as.Date(energy_df_annual_co2[[1]])\nenergy_df_annual_co2\n\n\n\n  \n\n\n\n\n\nCode\nvis_miss(energy_df_monthly_co2) + \n  theme(\n    axis.text.x = element_text(angle=270, hjust=1),\n    axis.title = element_text(size=10),\n    plot.title = element_text(hjust=0.5, face='bold', color='darkblue'),\n    plot.subtitle = element_text(hjust=0.5, color='darkblue')\n  ) +\n  labs(\n    title = \"Percentage of datapoints missing in each column\",\n    subtitle = \"Table: CO2 Emission Data (Monthly Data)\",\n    x = \"Column Variables\",\n    y = \"Number of Observations\"\n  )\n\n\n\n\n\n\n\n\n\nCode\nvis_miss(energy_df_annual_co2) + \n  theme(\n    axis.text.x = element_text(angle=270, hjust=1),\n    axis.title = element_text(size=10),\n    plot.title = element_text(hjust=0.5, face='bold', color='darkblue'),\n    plot.subtitle = element_text(hjust=0.5, color='darkblue')\n  ) +\n  labs(\n    title = \"Percentage of datapoints missing in each column\",\n    subtitle = \"Table: CO2 Emission Data (Annual Data)\",\n    x = \"Column Variables\",\n    y = \"Number of Observations\"\n  )\n\n\n\n\n\n\n\n\n\nThere is no missing data in any of the dataset as per the graph.",
    "crumbs": [
      "<span class='chapter-number'>2</span>  <span class='chapter-title'>Data</span>"
    ]
  },
  {
    "objectID": "results.html",
    "href": "results.html",
    "title": "3  Results",
    "section": "",
    "text": "3.1 Energy Production and Consumption Overview\nCode\ninvisible(library(readxl))\ninvisible(library(naniar))\ninvisible(library(ggplot2))\ninvisible(library(dplyr))\n\n\n\nAttaching package: 'dplyr'\n\n\nThe following objects are masked from 'package:stats':\n\n    filter, lag\n\n\nThe following objects are masked from 'package:base':\n\n    intersect, setdiff, setequal, union\n\n\nCode\ninvisible(library(tidyr))\ninvisible(library(stringr))\nCode\nenergy_df_annual &lt;- read_xlsx(path='./data_source/data/energy_overview_data.xlsx', sheet=2, skip=9)\nenergy_df_annual &lt;- energy_df_annual[-1, ]\nenergy_df_annual[, -1] &lt;- lapply(energy_df_annual[, -1], as.numeric)\ncolnames(energy_df_annual)[1] &lt;- \"Year\"\nenergy_df_annual",
    "crumbs": [
      "<span class='chapter-number'>3</span>  <span class='chapter-title'>Results</span>"
    ]
  },
  {
    "objectID": "results.html#energy-production-and-consumption-overview",
    "href": "results.html#energy-production-and-consumption-overview",
    "title": "3  Results",
    "section": "",
    "text": "3.1.1 Primary Energy Production\n\n\nCode\nggplot(energy_df_annual, aes(x=Year)) + \n  geom_line(aes(y=`Total Fossil Fuels Production`, color='Fossil Fuels Production')) +\n  geom_line(aes(y=`Nuclear Electric Power Production`, color='Nuclear Power Production')) +\n  geom_line(aes(y=`Total Renewable Energy Production`, color='Renewable Energy Production')) +\n  labs(\n    title='Primary Energy Production',\n    x = 'Year',\n    y = 'Production (Quadrillion Btu)',\n    caption = 'Data Source: U.S. Energy Information Association',\n  ) + \n  theme(\n    plot.title = element_text(hjust=0.5, face='bold', color='darkblue'),\n    legend.position = 'bottom',\n    legend.box = 'horizontal',\n    legend.title = element_blank()\n  ) +\n  scale_color_manual(values = c('Fossil Fuels Production' = 'red', \n                                'Nuclear Power Production' = 'blue', \n                                'Renewable Energy Production' = 'green'))\n\n\n\n\n\n\n\n\n\nThe graph illustrates the trend in primary energy production from 1950 to 2020. Initially, there is a steady increase from approximately 28 quadrillion Btu in 1950 to 59 quadrillion Btu by 1970. This is followed by a plateau in production from 1970 to 2010. After 2010, there is a noticeable spike in production, which may be attributed to advancements in high-performance computing in large data centers which needs high energy.\nFossil Fuels Production : This line shows a significant increase over the years, indicating a substantial rise in energy production. It suggests that this energy source has been the dominant contributor to primary energy production.\nNuclear and Renewable Energy Production : These lines remain relatively flat compared to the fossil fuel, indicating that these energy sources have contributed less to the overall primary energy production. They show slight increases over time but are not as pronounced as the fossil fuel.\n\n\n3.1.2 Primary Energy Consumption\n\n\nCode\nggplot(energy_df_annual, aes(x=Year)) +\n  geom_line(aes(y=`Total Fossil Fuels Consumption`, color='Fossil Fuels Consumption')) +\n  geom_line(aes(y=`Nuclear Electric Power Consumption`, color='Nuclear Power Consumption')) +\n  geom_line(aes(y=`Total Renewable Energy Consumption`, color='Renewable Energy Consumption')) +\n  labs(\n    title='Primary Energy Consumption',\n    x='Year',\n    y='Consumption (Quadrillion Btu)',\n    caption = 'Data Source: U.S. Energy Information Association'\n  ) + \n  scale_color_manual(\n    values = c(\n      'Fossil Fuels Consumption' = 'red',\n      'Nuclear Power Consumption' = 'blue',\n      'Renewable Energy Consumption' = 'green'\n    )\n  ) +\n  theme(\n    plot.title = element_text(hjust=0.5, face='bold', color='darkblue'),\n    legend.position = 'bottom',\n    legend.box = 'horizontal',\n    legend.title = element_blank()\n  )\n\n\n\n\n\n\n\n\n\nFossil Fuels Consumption : This is the dominant source of energy consumption throughout the period. There is a steady increase from 1950 to around 2005, with some fluctuations. After 2005, the consumption plateaus with minor ups and downs.\nNuclear Power Consumption : This energy consumption starts to become little significant around the late 1960s and early 1970s. It shows gradual growth until about 2000, after which it stabilizes.\nRenewable Energy Consumption : This energy consumption begins to rise noticeably in the late 1990s. It shows a steady increase, especially post-2000, and appears to be catching up with nuclear power by the end of the period.\nThe fossil fuels make a large chunk of energy consumption throughout the years. The other energy consumption source like nuclear and renewable has very little contribution. There is a serious need of investments in these energy sources in order to catch up or reduce the dependence of fossil fuels.\n\n\n3.1.3 Primary Energy Imports and Exports\n\n\nCode\nggplot(energy_df_annual, aes(x=Year, y=`Primary Energy Net Imports`)) + \n  geom_bar(stat = 'identity', fill='orange', color='black') + \n  labs(\n    title='Primary Energy Net Imports',\n    x = 'Year',\n    y = 'Energy (Quadrillion Btu)',\n    caption = 'Data Source: U.S. Energy Information Associaton'\n  ) + \n  theme(\n    plot.title = element_text(hjust=0.5, face='bold', color='darkblue'),\n  )\n\n\n\n\n\n\n\n\n\nThe chart shows the net imports of primary energy into the United States over time.\nObservations :\n\n1950s to Early 1970s: The net energy imports were relatively low and stable. This period shows minimal dependency on energy imports.\nMid-1970s to Early 1980s: There was a noticeable increase in net energy imports, likely due to rising energy demands and geopolitical events affecting oil supply. Since the 1970s, the global oil trade has been predominantly conducted in U.S. dollars (USD), creating a symbiosis between America’s currency and the world’s most traded commodity. The petrodollar emerged as an economic concept in the 1970s as growing U.S. imports of increasingly costly crude oil increased the dollar holdings of foreign producers.\n1980s to Early 2000s: A significant rise in net imports occurred, peaking around the mid-2000s. This reflects increased energy consumption and reliance on foreign energy sources. The U.S. experienced growing energy demands driven by economic expansion and technological advancements. This led to higher consumption of oil and natural gas. The U.S. became increasingly reliant on foreign oil, with imports rising significantly.\nMid-2000s to Present: There is a sharp decline in net imports, eventually turning negative. This indicates that the U.S. became a net exporter of primary energy. Factors contributing to this include increased domestic energy production (especially from shale gas and oil), improved energy efficiency, and shifts towards renewable energy sources. (Source: U.S. Energy Independence)\n\nOverall, the chart illustrates a transition from high dependency on imported energy to a position where the U.S. exports more energy than it imports.",
    "crumbs": [
      "<span class='chapter-number'>3</span>  <span class='chapter-title'>Results</span>"
    ]
  },
  {
    "objectID": "data.html#combining-data",
    "href": "data.html#combining-data",
    "title": "2  Data",
    "section": "2.4 Combining Data",
    "text": "2.4 Combining Data\nManaging 19 separate Excel files for data analysis can be a challenging and time-consuming process, as it requires handling multiple file operations, ensuring consistency across datasets, and potentially dealing with overlapping or missing data. A more efficient approach is to consolidate all the data into a single table structure. By doing so, we eliminate the need for complex and computationally expensive join operations, simplify the workflow, and significantly reduce the amount of code required to process and analyze the data. This approach not only streamlines the data analysis process but also minimizes errors and improves overall efficiency.\n\n2.4.1 Merging the monthly data\n\n\nCode\nfolder_path &lt;- './data_source/data'\n\nfile_list &lt;- list.files(path = folder_path, pattern = '\\\\.xlsx$', full.names =TRUE)\n\nread_file_skip_rows &lt;- function(file_path){\n  df &lt;- read_xlsx(file_path, sheet=1, skip=9)\n  new_colnames &lt;- c(names(df)[1], paste(names(df)[-1], as.character(df[1, -1]), sep = \" \"))\n  colnames(df) &lt;- new_colnames\n  df &lt;- df[-1, ]\n  df[, -1] &lt;- lapply(df[, -1], as.numeric)\n  df[[1]] &lt;- as.Date(df[[1]])\n  return (df)\n}\n\ndata_list &lt;- lapply(file_list, read_file_skip_rows)\n\ncombined_data &lt;- Reduce(function(x, y) merge(x, y, by='Month', all=TRUE), data_list)\n\nwrite_xlsx(combined_data, path='./data_source/combined_monthly_data.xlsx')\n\n\n\n\n2.4.2 Merging the annual data\n\n\nCode\nfolder_path &lt;- './data_source/data'\n\nfile_list &lt;- list.files(path = folder_path, pattern = '\\\\.xlsx$', full.names =TRUE)\n\nread_file_skip_rows &lt;- function(file_path){\n  df &lt;- read_xlsx(file_path, sheet=1, skip=9)\n  new_colnames &lt;- c(names(df)[1], paste(names(df)[-1], as.character(df[1, -1]), sep = \" \"))\n  colnames(df) &lt;- new_colnames\n  colnames(df)[1] &lt;- 'Year'\n  df &lt;- df[-1, ]\n  df[, -1] &lt;- lapply(df[, -1], as.numeric)\n  df[[1]] &lt;- as.Date(df[[1]])\n  return (df)\n}\n\ndata_list &lt;- lapply(file_list, read_file_skip_rows)\n\ncombined_data &lt;- Reduce(function(x, y) merge(x, y, by='Year', all=TRUE), data_list)\n\nwrite_xlsx(combined_data, path='./data_source/combined_annual_data.xlsx')",
    "crumbs": [
      "<span class='chapter-number'>2</span>  <span class='chapter-title'>Data</span>"
    ]
  }
]